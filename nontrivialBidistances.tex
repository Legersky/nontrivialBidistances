\documentclass[a4paper, 11pt]{article}

\usepackage{cite}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
% \usepackage[IL2]{fontenc}  
% \usepackage{amsmath,amsthm} 
% \usepackage{amsfonts}
\usepackage{amsmath, amsthm, amssymb, units, dsfont}

\usepackage[fixlanguage]{babelbib}
\selectbiblanguage{english}

\usepackage[pdfauthor={Jan Legersk\'y},
            pdfproducer={Jan Legersk\'y},
            pdfcreator={pdflatex},
            pdfencoding=unicode]{hyperref}
           
\usepackage{enumerate}
\usepackage[pdftex]{graphicx,color}


\newcommand{\komentar}[1]{\textcolor{red}{#1} \newline}

\newcommand{\trcomp}{$\triangle$-component}
\newcommand{\trcomps}{$\triangle$-components}
\newcommand{\cv}[1]{c_v^{(#1)}}

\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}{Lemma}[section]
\newtheorem{cor}[lem]{Corollary}
\newtheorem*{rem}{Remark}

\theoremstyle{definition}
\newtheorem{defn}{Definition}[section]
\newtheorem{exmp}{Example}[section]
\newtheorem{conj}{Conjecture}

\begin{document}
\begin{defn}
If $G$ is a graph, then $V_G$ is the set of vertices of $G$ and $E_G$ is the set of edges of $G$.
\end{defn}

\begin{defn}
\emph{A graph $G=(V,E)$ has a nontrivial bidistance} if the bigraph $(G,G)$ has a nontrivial bidistance with the trivial weight vector $w$, i.e., $w(e)=0$ for all $e\in E$.
\end{defn}

\begin{rem}
By \emph{a cycle} we always mean a simple cycle.
\end{rem}


\section{Graphs with a vertex which is not contained in $C_3\subset G$}
\begin{lem}
A graph $G$ has a bidistance $d_G$ if and only if the minimum of $d_G$ occurs more than once in every cycle of $G$ and the same for the maximum.
\end{lem}
\begin{proof}
The maximum of $d_G$ corresponds to the minimum of $-d_G$ and vice versa. The claim follows by the definition of bidistance.
\end{proof}

\begin{cor}
\label{cor:binaryLabelling}
A graph $G$ has a nontrivial bidistance $d_G$ iff there exists an edge labeling $\delta:E\rightarrow \{0,1\}$ such that $\delta(E)=\{0,1\}$ and for every cycle in $G$, neither 0 or 1 occurs exactly once.
\end{cor}
\begin{proof}
$\implies$: We may assume that $d_G(E)$ has at least one positive element, otherwise take $-d_G$. Set
\begin{align*}
\delta(e)&=1 \qquad \text{if } d_G(e)>0 \\
		&=0 \qquad \text{otherwise.}
\end{align*}
If we consider a cycle $C$ in $G$, then there are following possibilities:
\begin{enumerate}
	\item $\max_{e\in C} d_G(e) \leq 0 \implies \delta(e)=0$ for all $e \in C$.
	\item If $\max_{e\in C} d_G(e) > 0 \geq \min_{e\in C} d_G(e)$, then $\delta(e)=1$ for at least two distinct edges by the previous lemma and the same for $\delta(e)=0$.
	\item $\min_{e\in C} d_G(e) > 0 \implies \delta(e)=1$ for all $e \in C$.
\end{enumerate}
$\impliedby$: Take $d_G(e)=\delta(e)$ for all $e\in E$ if $\delta(\bar{e})=0$, or $d_G(e)=1-\delta(e)$ if $\delta(\bar{e})=1$, where $\bar{e}$ is the distinguished edge.
\end{proof}


\begin{rem}
Obviously, if a disconnected graph has at least two components which contain an edge, then it has a nontrivial bidistance. Also any graph with at least two edges and some vertex of degree one has a nontrivial bidistance.
\end{rem}

\begin{thm}
\label{thm:vertexNotInTriangle}
Let $G=(V,E)$ be a connected graph such that $|V|\geq 3$. If there is a vertex $v_0 \in V$ such that it is not contained in any triangle $C_3\subset G$, then $G$ allows a nontrivial bidistance. Moreover, $G$ has a non-rigid realization (informal proof...).
\end{thm}
\begin{proof}
Set
\begin{align*}
\delta(e)&=1 \qquad \text{if } v_0 \in e \\
		&=0 \qquad \text{otherwise.}
\end{align*} 
Now consider a cycle $C$ in $G$. If $v_0\notin C$, then $\delta(e)=0$ for all $e\in C$. If $v_0\in C$ then the label 1 occurs exactly twice (for the edges adjacent to $v_0$) and the label 0 at least twice as the length of C is at least four.

If there exists an edge which is not associated to $v_0$, then $\delta(E)=\{0,1\}$. Otherwise, the graph $G$ is a star, i.e., it has clearly a nontrivial bidistance.

To obtain a non-rigid realization, put all neighbours of $v_0$ to the same point $p$. This is allowed as they are non-adjacent. Now the vertex $v_0$ can rotate around $p$.
\end{proof}

\section{Graphs with all vertices in some $C_3\subset G$}
Now we focus on graphs which do not satisfy the condition of Theorem~\ref{thm:vertexNotInTriangle}.
 

\begin{defn}
Let $G=(V,E)$ be a connected graph such that for all $v\in V$ there is some $C_3\subset G$ such that $v\in C_3$. We define a relation on $E\times E$ by 
$$e_1 \sim_{\!\!\bigtriangleup} e_2 \iff e_1=e_2 \text{ or } \exists\, C_3\subset G: e_1, e_2\in C_3\,.$$
Let $E_1, \dots, E_n$ be equivalence classes of the transitive closure of $\sim_{\!\!\bigtriangleup}$ on $E$. The subgraph $T_i=(V_i,E_i)$ of $G$, where  $V_i=\{v\in V | \exists\, e\in E_i \colon v\in e\}$, is called a \emph{\trcomp{} (triangle-component)} if $|E_i|\geq 3$, and a \emph{connecting edge} otherwise.
\end{defn}

\begin{rem}
Every vertex is in some \trcomp{} as it is contained in some $C_3$. There might be \trcomps{} $T,T'$ such that $V_T \cap V_{T'}\neq \emptyset$. But always $E_T \cap E_{T'}= \emptyset$.
\end{rem}

\begin{rem}
From now on, we implicitly assume that $G=(V,E)$ is such that for all $v\in V$ there is some $C_3\subset G$ such that $v\in C_3$ whenever we use concept of \trcomps{} or connecting edges.
\end{rem}

\begin{lem}
\label{lem:bidistanceInTrcomp}
Let $d_G$ be a bidistance of a graph $G$. If $T$ is a \trcomp{} of $G$, then $d_G(e)=d_G(e')$ for all $e,e'\in E_T$.
\end{lem}
\begin{proof}
It is enough to prove that $e \sim_{\!\!\bigtriangleup} e'$ implies that $d_G(e)=d_G(e')$. That must be true, otherwise the maximum or minimum occurs only once in $C_3\subset G$ such that $e,e'\in C_3$.
\end{proof}





\begin{defn}
Let $G=(V,E)$ be a graph. A vertex $v\in V$ is called \emph{multiple vertex of multiplicity} $k$ if there exists exactly $k$ distinct \trcomps{} which contain $v$. A vertex $u\in V$ is called \emph{connecting vertex} if it is a multiple vertex or an endpoint of some connecting edge.
\end{defn}

\begin{lem}
If $T$ is a \trcomp{}, then $|E_T|\geq 2|V_T|-3$.
\label{lem:sizeTriangleComponent}
\end{lem}
\begin{proof}
If all vertices are of degree at least four, then $$2|E_T|=\sum_{v\in V_T} \deg(v) \geq 4|V_T|\,,$$ which implies $|E_T|\geq 2|V_T|\geq 2|V_T|-3$.

If there is a vertex $v\in V_T$ such that $\deg(v)<4$, we proceed by induction with the respect to the number of vertices. Obviously, the inequality holds for triangle. If the degree of $v$ is two, then by induction assumption
$$
|E_T|=|E_{T\setminus v}|+2\geq 2 |V_{T\setminus v}|-3 +2\geq 2 (|V_{T\setminus v}|+1)-3=2 |V_{T}|-3\,.
$$
We have two cases for $\deg(v)=3$. Firstly, $T\setminus v$ is a \trcomp{}. Now $$|E_T|=|E_{T\setminus v}|+3\geq 2 |V_{T\\v}|-3 +3\geq 2 (|V_{T\setminus v}|+1)-2\geq 2 |V_{T}|-3\,.$$ Secondly, $T\setminus v$ consists of two \trcomps{} $T_1$ and $T_2$. We have
\begin{align*}
|E_T|=|E_{T_1}|+|E_{T_1}|+3 &\geq (2 |V_{T_1}|-3)+(2 |V_{T_2}|-3) +3 \\
			&= 2(|V_{T_1}| +|V_{T_2}|)-3=2 |V_{T}|-3\,,
\end{align*}
where we use the fact that $|V_{T_1} \cap V_{T_2}|=1$.
\end{proof}



\begin{lem}
\label{lem:noEdgeInSameComponent}
If $T$ is a \trcomp{} of  a Laman graph $G$, then $T$ is a Laman graph and there is no connecting edge with both vertices in $T$.
\end{lem}
\begin{proof}
The Laman conditions and Lemma~\ref{lem:sizeTriangleComponent} give $|E_T|= 2|V_T|-3$, hence $T$ is a Laman graph.

If there is a connecting edge with both vertices in $T$, then
$$
|E_{T\cup e}|=|E_T| +1 =2|V_T| -3+1\,,
$$
which contradicts that $G$ is Laman.
\end{proof}

\begin{lem}
\label{lem:threeEdgesOrVertexAndEdge}
Let $G$ be a Laman graph. If $T_1$ and $T_2$ are its \trcomps{}, then they can be connected by at most three connecting edges or by one multiple vertex with possibly one connecting edge. If there are three connecting edges, then all three cannot have a common vertex.
\end{lem}
\begin{proof}
Let $c_v$ be the number of multiple vertices, i.e., $c_v=|V_{T_1}\cap V_{T_2}|$, and $c_e$ be the number of connecting edges between $T_1$ and $T_2$. Using that $|E_{T_i}|= 2|V_{T_i}|-3$ and the Laman condition, we have
\begin{align*}
2(|V_{T_1}|+|V_{T_2}|)-6 +c_e&=|E_{T_1}|+|E_{T_2}|+c_e=|E_{H}| \\
&\leq 2|V_H| -3=2(|V_{T_1}|+|V_{T_2}|-c_v)-3\,,
\end{align*}
where subgraph $H$ is given by the union of $T_1$, $T_2$ and connecting edges. Hence $c_e+2c_v \leq 3$ which implies the first part of the statement. For the second one, assume that there are three connecting edges with the common vertex  $v\in T_2$. If $H'$ is the subgraph obtained by union of $T_1$, $v$ and the connecting vertices, then
$$
|E_{H'}|=|E_{T_1}|+3=2|V_T|=2(|V_T|+1)-2=2|V_{H'}|-2\,,
$$
which is a contradiction with the Laman condition.
\end{proof}

\begin{defn}
Let $T_1, \dots, T_n$ be \trcomps{} of a Laman graph $G$. Denote by $c_e$ the number of all connecting edges and by $\cv{k}$ the number of multiple vertices of multiplicity $k$.
\end{defn}

\begin{lem}
\label{lem:numCvCe}
If  $T_1, \dots, T_n$ are \trcomps{} of a Laman graph $G=(V,E)$, then
$$
3(n-1)=c_e + 2\sum_{k=2}^n \cv{k}(k-1)\,.
$$
\end{lem}
\begin{proof}
For every $T_i=(V_i,E_i)$ the equality $|E_i|=2|V_i|-3$ holds. For the number of vertices, we have
$$
|V|=\sum_{i=1}^n |V_i| - \sum_{k=2}^n \cv{k}(k-1)\,.
$$
Now we can obtain
\begin{align*}
c_e+\sum_{i=1}^n (2|V_i|-3)&=c_e + \sum_{i=1}^n |E_i|= |E|\\
	&=2|V|-3 = 2\sum_{i=1}^n |V_i| - 2\sum_{k=2}^n \cv{k}(k-1) -3\,.
\end{align*}
Hence
$$-3n + c_e= - 2\sum_{k=2}^n \cv{k}(k-1) -3\,,
$$
which gives the claim.
\end{proof}

\begin{lem}
\label{lem:twoConnectingVertices}
If $u,v\in V$ are two multiple vertices such that their multiplicities are $r$ and $s$, then
$$
r+s\leq n+1\,.
$$
\end{lem}
\begin{proof}
The vertex $u$ connects $r$ \trcomps{} which one of them can contain $v$. But there must be another $s-1$ \trcomps{} which contain $v$, otherwise there are two \trcomps{} that are connected by two vertices which contradicts Lemma~\ref{lem:threeEdgesOrVertexAndEdge}. Hence, there is at least $r+s-1$ distinct \trcomps{}.
\end{proof}

\begin{cor}
\label{cor:validCv}
Let $n\geq 2$ be the number of \trcomps{} in a Laman graph. The following statements hold:
\begin{enumerate}[i)]
	\item $\cv{n} \leq 1$.
	\item If $\cv{n} = 1$, then $\cv{k}=0$ for all $2\leq k<n$.
	\item If $n\geq 4$, then $\cv{n-1} \leq 1$.
	\item If $\cv{n-1} = 1$, then $\cv{k}=0$ for all $3\leq k<n-1$.
\end{enumerate}
\end{cor}
\begin{proof}
We always take two multiple vertices to get a contradiction with Lemma~\ref{lem:twoConnectingVertices}:
\begin{enumerate}[i)]
	\item $n+n >n +1$.
	\item $n +k>n+1$.
	\item $n-1+n-1>n+1$ for $n\geq 4$.
	\item $n-1+k>n+1$
\end{enumerate}
\end{proof}

\begin{thm}
\label{thm:componentWithNonadjacentVertices}
Let $G$ be a Laman graph with at least two \trcomps{}. If there is a \trcomp{} $T$ in $G$ such that no pair of its connecting vertices is adjacent, then $G$ has a nontrivial bidistance.  Moreover, $G$ has a non-rigid realization (informal proof...).
\end{thm}
\begin{proof}
We use Corollary~\ref{cor:binaryLabelling} for the proof. Set 
\begin{align*}
\delta(e)&=1 \qquad \text{if } e\in T \\
		&=0 \qquad \text{otherwise.}
\end{align*} 
All cycles going through $T$ contains the label 1 at least twice as there is no edge between connecting vertices. Also, there are at least two labels 0, if a cycle is not only in $T$, since there is no connecting edge with both endpoints in $T$ by Lemma~\ref{lem:noEdgeInSameComponent}. Obviously, $\delta(E)=\{0,1\}$ as there are at least two \trcomps{}.

A non-rigid realization can be obtained by putting all connecting vertices into one point. This is possible since they are non-adjacent. The \trcomp{} can rotate around this point.
\end{proof}

\begin{cor}
Let $T_1$ and $T_2$ be distinct \trcomps{} or connecting edges of a Laman graph $G$. If $T_i$ has only two connecting vertices $u$ and $v_i$ (or $T_i=uv_i$ if $T_i$ is a connecting edge) for $i\in\{1,2\}$, then  the graph $G$ has a nontrivial bidistance.  Moreover, $G$ has a non-rigid realization (informal proof...).
\end{cor}
\begin{proof}
We have $uv_1\notin E$ or $uv_2\notin E$ or $v_1v_2\notin E$, otherwise $T_1$ and $T_2$ coincide.
If $uv_1\notin E$ or $uv_2\notin E$, the statement follows from Lemma~\ref{thm:componentWithNonadjacentVertices}.

If $v_1v_2\notin E$, we set 
\begin{align*}
\delta(e)&=1 \qquad \text{if } e\in T_1\cup T_2 \\
		&=0 \qquad \text{otherwise.}
\end{align*} 
If a cycle goes through $T_1$ or $T_2$, then it must go through  $v_1, u$ and $v_2$. Therefore, the label 1 is there at least twice. At the same time, there are at least two labels 0 since  $v_1v_2\notin E$.

If we place $v_1$ and $v_2$ into one point, then $T_1$ and $T_2$ can rotate around this point.
\end{proof}

\begin{lem}
\label{lem:numEdgesBetweenTwoParts}
Let $G=(V,E)$ be a Laman graph. If $H_1=(V_1,E_1)$ and $H_2=(V_2,E_2)$ are induced subgraphs of $G$ such that $V_1 \cap V_2=\emptyset$ and $V=V_1\cup V_2$, then the set $E_c=\{uv\in E | u\in H_1 \text{ and } v\in H_2\}$ contains at least three edges.
\end{lem}
\begin{proof}
The statement follows from
$$
2(|V_1|+|V_2|)-3=2|V|-3=|E|=|E_1|+|E_2|+|E_c| \leq 2(|V_1|+|V_2|)-6 +|E_c|\,.
$$
\end{proof}

\begin{defn}
Let $G=(V,E)$ be a graph and $H$ be its subgraph. We say that the $H$ \emph{can be replaced by} a graph $H'$ in $G$ iff
$$
V_{H'}\cap V=\{v\in V_H | \exists\, u\in V\setminus V_H \colon uv\in E\}\,.
$$
The graph obtained by the replacement is defined as
$$
G_{H\rightarrow H'}=\left((V\setminus V_H)\cup V_{H'}, (E\setminus E_H)\cup E_{H'}\right)\,.
$$
\end{defn}

\begin{lem}
Let $L$ and $L'$ be Laman graphs such that $L$ can be replaced by $L'$ in a graph $G=(V,E)$. If $G$ is a Laman graph, then $G_{L\rightarrow L'}=(V',E')$ is also a Laman graph. 
\end{lem}
\begin{proof}
The Laman condition on the whole graph holds:
$$
|E'|=|E|- |E_{L}|+ |E_{L'}|=2(|V|- |V_{L}|+ |V_{L'}|)-3+3-3=2|V'|-3\,.
$$
Suppose in contradiction that there exist a subgraph $H'$ of $G_{L\rightarrow L'}$ such that $|E_{H'}|> 2|V_{H'}|-3$. Set 
\begin{align*}
 V_{in}&=V_{H'}\cap V_{L'}, &E_{in}&=E_{H'}\cap E_{L'}, \\
 V_{out}&=V_{H'} \setminus V_{in}, & E_{out}&=E_{H'} \setminus E_{in}
\end{align*}

Since $(V_{in}, E_{in})$ is a subgraph of the Laman graph $L'$, we have
$$
2|V_{in}|-3 +|E_{out}|\geq  |E_{in}|+|E_{out}|=|E_{H'}|> 2|V_{{H'}}|-3=2|V_{in}|+2|V_{out}|-3\,.
$$
Hence, $|E_{out}|>2|V_{out}|$. We take the subgraph $H=(V_L \cup V_{out}, E_L \cup E_{out})$ of $G$. Using that $|E_L|=2|V_L|-3$, we obtain
$$|E_H|=|E_L|+|E_{out}|>2|V_L|-3+2|V_{out}|=2|V_H|-3\,,$$
which is  a contradiction with $G$ being a  Laman graph.
\end{proof}

\begin{cor}
\label{cor:replaceTrcompByLaman}
Let $T$ be a connecting edge or \trcomp{} of a graph $G=(V,E)$ with connecting vertices $v_1, \dots, v_r$. If $L$ is a Laman graph with the set of vertices $V_L=\{v_1, \dots, v_r\}$ and $T$ is a Laman graph, then the graph $G_{T\rightarrow L}$ is a Laman graph iff $G$ is a Laman graph.
\end{cor}

\begin{lem}
\label{lem:trcompToEdge}
Let $T$ be a connecting edge or \trcomp{} of a Laman graph $G=(V,E)$ with only two connecting vertices $u$ and $v$. If $uv\in E$, then $G$ has a nontrivial bidistance iff $G_{T\rightarrow uv}$ has a nontrivial bidistance.
\end{lem}
\begin{proof}
Note that $G_{T\rightarrow uv}$ is a subgraph of $G$. Let $\delta_G$ and $\delta_{G_{T\rightarrow uv}}$ by the edge labelings which correspond to the bidistances of $G$ and $G_{T\rightarrow uv}$ according to Lemma~\ref{cor:binaryLabelling}.

$\implies$: The restriction of $\delta_G$ to  $G_{T\rightarrow uv}$ gives the labeling $\delta_{G_{T\rightarrow uv}}$.

$\impliedby$: Define $\delta_G(e)=\delta_{G_{T\rightarrow uv}}(e)$ for all $e\in E_{G_{T\rightarrow uv}}$ and $\delta_G(e)=\delta_{G_{T\rightarrow uv}}(uv)$ for all $e\in E_T$. Since for every cycle going through $uv$, the label $\delta_{G_{T\rightarrow uv}}(uv)$ occurs at least twice, it must occur at least twice in arbitrary cycle going  through $T$.
\end{proof}

\begin{thm}
\label{thm:cutByVertices}
Let $G=(V,E)$ be a Laman graph. If $V_{c}=\{v_1, \dots v_r\}$ are some of the connecting vertices of $G$ which are pairwise non-adjacent and $G\setminus V_c$ is disconnected, then $G$ has a nontrivial bidistance. Moreover, $G$ has a non-rigid realization.
\end{thm}
\begin{proof}
Let $M$ and $N$ be the disconnected parts of $G\setminus V_c$. Let $M_v$ and $N_v$ be the subgraphs of $G$ which are induced by $V_M\cup \{v\}$ and $V_N\cup \{v\}$. Set $\delta(e)=1$ if $e\in E_{M_v}$, and $\delta(e)=0$ otherwise. Let $C$ be a cycle in $G$. If $M \subset G$, resp. $N \subset G$, then all labels in $C$ are 0, resp. 1. If $C$ goes through both $M$ and $N$, then there exist $v_i$ and $v_j$ such that $v_i, v_j\in C$. At least two edges of $C$ must be in $M$ and the same for $N$ since $v_j$ and $u_i$ are non-adjacent. Hence, there are at least two labels 0 and at least two labels 1 within the cycle.

A non-rigid realization can be obtained by putting all connecting vertices into one point. The \trcomp{} can rotate around this point.
\end{proof}


\begin{thm}
\label{thm:cutToTwoParts}
Let $G=(V,E)$ be a Laman graph. Let  $T_1, \dots, T_r$ be some of the \trcomps{} of $G$ which have only two connecting vertices, namely $u_1, v_1, \dots u_r,v_r$, where  $T_i=(V_i,E_i)$ and $u_i, v_i\in V_i$. Let  $u_{r+1}v_{r+1}, \dots u_s v_s$ be some of the connecting edges of $G$. Let $G'$ be the graph obtained from $G$ by replacing $T_i$, resp. $u_iv_i$, by $(\{u_i, v_i\}, \emptyset)$ for all $i\in \{1, \dots, s\}$.
% Set 
%\begin{align*}
%V_{ncon}&=\left\{v\in V_1 \cup \dots \cup V_r | v\notin \{u_1, \dots u_r\}\cup \{v_1, \dots v_r\} \right\} \qquad \text{and} \\
%E_{con}&=E_1 \cup \dots \cup E_r \cup \{u_{r+1}v_{r+1}, \dots u_s v_s\}\,.
%\end{align*}
If $u_1, \dots, u_s$ are in the different connected component(s) of the graph $G'$ than $v_1, \dots, v_s$, then there exists a nontrivial bidistance.  Moreover, $G$ has a non-rigid realization (informal proof...).
\end{thm}
\begin{proof}
We remark that there might be no \trcomps{} ($r=0$) or no connecting edges ($s=r$), but always $s\geq 3$ by Lemma~\ref{lem:numEdgesBetweenTwoParts} and Corollary~\ref{cor:replaceTrcompByLaman}.

If there is $T_i$ such that $u_i v_i \notin E$, then there exists a nontrivial bidistance by Theorem~\ref{thm:componentWithNonadjacentVertices}.
Otherwise, we may assume that there are only connecting edges  $u_1 v_1, \dots u_r v_r$ instead of \trcomps{} $T_1, \dots, T_r$ according to Lemma~\ref{lem:trcompToEdge}.

The idea is following: since the graph $G'\subset G$ is disconnected, every cycle in $G$ which does not stay in a connected component of $G'$ must go through the given  connecting edges at least twice.

We may assume that all $u_1, \dots, u_s$ are in the same connected component $M$, because if we can construct a bidistance in such case, then we may just forgot all connecting edges associated to the elements of $\{u_1, \dots, u_s\}$ which are not in the given connected component in the general case. By the same argument, we may assume that $\{v_1, \dots, v_s\}$ are in one connected component $N$. Thus $G'$ consists of only two connected components $M$ and $N$, otherwise $G$ is not connected. In fact, $M$ and $N$ are induced subgraphs of $G$ linked by the connecting edges $\{u_1v_1, \dots, u_sv_s\}$.

Set $\delta(u_i v_i)=1$ for all $i\in \{1, \dots, s\}$ and $\delta(e)=0$ otherwise. Let $C$ be a cycle in $G$. If $C\subset M$ or  $C\subset N$, then all labels are 0. Otherwise, $C$ contains some $u_iv_i$ and $u_jv_j$ such that $u_iv_i\neq u_jv_j$. Hence, the label 1 is in $C$ at least twice. If $u_i\neq u_j$ and $v_j\neq v_j$, then there must be at least one edge in $M\cap C$ and at least one edge in $N\cap C$.  If $u_i=u_j$, then $v_i$ and $v_j$ are non-adjacent, otherwise $u_iv_i \sim_{\!\!\bigtriangleup} u_jv_j$. Thus, there are at least two edges in $C\cap N$. The case $v_i=v_j$ is analogous. Therefore, the label 0 is in $C$ at least twice.

If we choose such a realization that all edges $\{u_1v_1, \dots, u_sv_s\}$ are parallel and have the same length, then $M$ can move around $N$ along a circle.
\end{proof}

\begin{cor}
If $G$ is a Laman graph with $n$ \trcomps{} such that $\sum_{k=2}^n \cv{k}(k-1) < n-1$ (or equivalently $c_e>n-1$), then $G$ has a nontrivial bidistance.
\end{cor}
\begin{proof}
The equivalent assumption condition follows from Lemma~\ref{lem:numCvCe}.

Each multiple vertex with multiplicity $k$ can connect at most $k-1$ \trcomps{} to the previous one. Thus, at most $1+\sum_{k=2}^n \cv{k}(k-1)$ \trcomps{} can be connected by multiple vertices. Therefore, if $1+\sum_{k=2}^n \cv{k}(k-1) <n$, then there exists a \trcomp{} connected only by connecting edges. Theorem~\ref{thm:cutToTwoParts} implies that $G$ has a nontrivial bidistance.
\end{proof}

\begin{thm}
Let $G$ be a Laman graph with \trcomps{} $T_1,\dots, T_n$. If $n=1$, then there is no nontrivial bidistance. If $n=2,3,4$ or $5$, then $G$ allows nontrivial bidistance.
\end{thm}
\begin{proof}[Proof (sketch)]
If $n=1$, then all edges have the same bidistance by Lemma~\ref{lem:bidistanceInTrcomp}, i.e. 0.

For $n=2,3,4$ or $5$, we consider all valid combinations of $c_e$ and $\cv{k}$ according to Lemma~\ref{lem:numCvCe} and Corollary~\ref{cor:validCv}. We construct all possible valid schemes of connections of $n$ \trcomps{} with $c_e$ connecting edges and $\cv{k}$ multiple vertices by using Lemma~\ref{lem:threeEdgesOrVertexAndEdge}. For all of them, the existence of a bidistance follows from Theorem~\ref{thm:componentWithNonadjacentVertices}, \ref{thm:cutByVertices} or \ref{thm:cutToTwoParts}.
\end{proof}

\begin{thm}
Let $G$ be a Laman graph constructed only by Henneberg moves of type I. The graph $G$ has a nontrivial bidistance iff the number of \trcomps{} is at least two.
\end{thm}
\begin{proof}
$\implies$: If there is only one \trcomp{}, then all edges have the same bidistance by Lemma~\ref{lem:bidistanceInTrcomp}.

$\impliedby$:
Let $(\{v_0,v_1\}, \{v_0v_1\})= G_1, \dots, G_s=G$ be a sequence of graphs given by a sequence of Henneberg moves of type I, $G_i=(V_i,E_i)$. For each $G_i$, we construct by induction an edge labeling $\delta_i$ which corresponds to a bidistance of $G_i$ according to Corollary~\ref{cor:binaryLabelling}. Set $\delta_0(v_0v_1)=0$. Let $\delta_{i-1}$ be the edge labelling of $G_{i-1}$ and the new vertex $v_i$ is linked to vertices $u,v \in G_{i-1}$.
We distinguish two cases:
\begin{enumerate}[a)]
	\item If $uv\in E_{i-1}$, then $\delta_i(e)=\delta_{i-1}(e)$ for all $e \in E_{i-1}$ and $\delta_{i}(uv_i)=\delta_{i}(vv_i)=\delta_{i-1}(uv)$.
	\item If $uv\notin E_{i-1}$, then $\delta_i(e)=0$ for all $e \in E_{i-1}$ and $\delta_{i-1}(uv_i)=\delta_{i-1}(vv_i)=1$.
\end{enumerate}
For any cycle in $G_i$, neither 0 or 1 for $\delta_i$ occurs exactly ones. The reasoning for a) is the same as in Lemma~\ref{lem:trcompToEdge} and for b) as in Theorem~\ref{thm:vertexNotInTriangle}.

If all moves are of type a), then clearly $G$ has only one \trcomp{}. Otherwise, we have a nontrivial bidistance for the graph $G$.
\end{proof}


\begin{conj}
Let $G$ be a Laman graph with \trcomps{} $T_1,\dots, T_n$. There exists a nontrivial bidistance iff $n>1$.
\end{conj}


\section{Construction of \trcomps{} by Henneberg moves}

\begin{lem}
\label{lem:neigboursInduceTree}
Let $T$ be a \trcomp{} of a Laman graph. If $v\in V_T$, then the subgraph $N$ of $T$ induced by the neighbours of $v$ is a tree.
\end{lem}
\begin{proof}
Let $M$ be the subgraph of $T$ induced by $V_N \cup \{v\}$. The Laman condition implies
$$
\deg_T (v)+|E_N|=|E_M| \leq 2|V_M|-3=2(\deg_T(v)+1)-3\,.
$$
Hence, $|E_N| \leq \deg_T(v)-1$.
By the definition of \trcomp{}, for every $u\in V_N$ there must be $u'\in V_N$ such that $uu' \in E_N$. If $N$ is connected, then $|E_N|\geq|V_N|-1=\deg_T(v)-1$. Therefore, $|E_N| = |V_N|-1$ and $N$ is connected, i.e., $N$ is a tree.

Suppose that $N$ is not connected. Let $N_1$ be one of the  connected components of $N$ and let $N_2$ be the union of rest of them. Let $v'\notin V_T$ be some new vertex.  We can construct the graph 
$$T'=\left(V_T\cup \{v'\}, \left(E_T\setminus \{vw|w\in E_{N_1}\}\right)\cup\{v'w|w\in E_{N_1}\}\right)\,.$$
Since edges $E_{N_1}$ are in equivalence (meaning transitive closure of $\sim_{\!\!\bigtriangleup}$) with edges $E_{N_2}$, but there is no edge from $V_{N_1}$ to $V_{N_2}$, the graph $T'$ is a \trcomp{}. It is a contradiction since $|E_T|=|E_{T'}|$, but $|V_T|=|V_{T'}|-1$.
\end{proof}

\begin{defn}
Let $v\in G=(V,E)$ be constructed by Henneberg move of type I from vertices $u,u'$. If $uu'\in E$, we say that $v$ was constructed from $u,u'$ by \emph{Henneberg move of type Ia}, otherwise by \emph{Henneberg move of type Ib}.
\end{defn}

\begin{defn}
Let a new vertex $v\in G=(V,E)$ be constructed by Henneberg move of type II so that it is linked by edges to the vertices $u,u_1,u_2 \in V$ and the edge $u_1u_2\in E$ is removed. If $uu_1\notin E$ and $uu_2\notin E$, we say that $v$ was constructed by \emph{Henneberg move of type IIa}. If $uu_1\in E$ xor $uu_2\in E$, we say that $v$ was constructed by \emph{Henneberg move of type IIb}. If $uu_1\in E$ and $uu_2\in E$, we say that $v$ was constructed by \emph{Henneberg move of type IIc}.

\end{defn}

\begin{lem}
\label{lem:trcompsCannotBeLinked}
If a Laman graph $G$ is constructed by Henneberg moves, then the number of \trcomps{} does not decrease during the construction. Moreover, the number of \trcomps{} and connecting edges together does not decrease, it means that if the number of connecting vertices decreases by some Henneberg move, then the number of \trcomps{} must increase.
\end{lem}
\begin{proof}
Let  $G_0, G_1, \dots, G_m=G$ be a sequence of graphs constructed by Henneberg moves in order to obtain $G$.
We show that the number of \trcomps{} of $G_{i}$ is greater or equal to the number of \trcomps{} of $G_{i-1}$ for all possible types of Henneberg moves:
\begin{itemize}
	\item Ia: If the new vertex $v$ is connected to a \trcomp{} of $G_{i-1}$, then $v$ is in the corresponding \trcomp{} of $G_i$. If the new vertex is connected to a connecting edge of $G_{i-1}$, then it forms a new \trcomp{} of $G_i$.
	\item Ib: Since the new edges of $G_i$ are not in any $C_3\subset G_i$, the number of \trcomps{} of $G_{i-1}$ equals the number of \trcomps{} of $G_{i}$ and there are two more connecting edges in $G_i$.
	\item II: Let $u,u_1,u_2\in V_{G_{i-1}}$ be such that $u_1u_2\in E_{G_{i-1}}$. The construction of $G_i$ from $G_{i-1}$ is following -- a new vertex $v$ is linked by edges to the vertices $u,u_1$ and $u_2$ and the edge $u_1u_2$ is removed. There are the following cases:
	\begin{itemize}
		\item IIa: If $uu_1, uu_2\notin E_{G_{i-1}}$, then none of $uv, u_1v$ or $u_2v$ is in any $C_3\subset G_i$. Hence, no \trcomps{} of $G_{i-1}$ can coincide in $G_i$. Moreover, some \trcomp{} of $G_{i-1}$ might be split in $G_{i}$ as the edge $u_1u_2$ is removed. Since there are three new connecting edges $uv, u_1v$ and $u_2v$, the number of connecting edges does not decrease even if the removed edge $u_1u_2$ is a connecting edge of $G_{i-1}$.
		\item IIb: If $uu_1\in E_{G_{i-1}}$ and $uu_2\notin E_{G_{i-1}}$, then $u_1v$ and $uv$ are in the same \trcomp{} of $G_i$ as $uu_1$. (Or they form a new one if $uu_1$ is a connecting edge in $G_{i-1}$.) Since the edge $u_2v$ is not in any $C_3\subset G_i$, no \trcomps{} of $G_{i-1}$ can coincide in $G_i$. Moreover, some \trcomp{} of $G_{i-1}$ might be split in $G_{i}$ as the edge $u_1u_2$ is removed. Even if the removed edge $u_1u_2$ is a connecting edge of $G_{i-1}$, there is the new connecting edge $u_2v$, i.e., it does not decrease the number of connecting edges.
		\item IIc: If $uu_1, uu_2\in E_{G_{i-1}}$, then $uu_1 \sim_{\!\!\bigtriangleup} uu_2$ in $G_{i-1}$ and also  $uu_1 \sim_{\!\!\bigtriangleup} uu_2$ in $G_{i}$. Therefore, the number \trcomps{} remains the same or it increases as the edge $u_1u_2$ is removed. None of the edges $uu_1, uu_2, u_1u_2$ can be a connecting edge of $G_{i-1}$ as they form a tringle. Hence, the number of connecting edges cannot decrease.
	\end{itemize}
\end{itemize}
\end{proof}

\begin{rem}
We do not require that all vertices are in some $C_3\subset G_i$ in the individual steps of construction. It does not matter, there just might be vertices which are not in any \trcomp{}.
\end{rem}

\begin{lem}
\label{lem:startWithArbitraryEdge}
If a \trcomp{} $T$ of a Laman graph can be constructed only by Henneberg moves of type Ia, then there exists a construction by Henneberg moves of type Ia which starts with an arbitrary edge $uv\in E_T$.
\end{lem}
\begin{proof}
We prove the claim by induction with respect to $|V_T|$. Clearly, triangle can be constructed from any of its edges. 

Let $G_0, G_1, \dots, G_m=T$ be sequence of graphs constructed by Henneberg moves of type Ia in order to obtain $T$. Let $G_i$ be such that it is constructed from $G_{i-1}$ by adjoining $v$ to an edge $uu'$. Now, we may construct $u'$ from the edge $uv$ and then construct the rest of $G_i$, since $G_{i-1}$ can be constructed from the edge $uu'$ by the induction assumption. Then we construct $T$ by the sequence $G_{i+1}, \dots, G_m=T$.
\end{proof}

\begin{thm}
\label{thm:everyTrcompByIa}
Every \trcomp{} $T$ of a Laman graph can be constructed by Henneberg moves of type Ia and a construction can start with an arbitrary edge.
\end{thm}
\begin{proof}
We proceed by induction with respect to $|V_T|$. The statement is obvious for triangle. Since $T$ is a Laman graph by Lemma~\ref{lem:noEdgeInSameComponent}, there exists a vertex $v\in V_T$ such that $T$ is constructed from $T'$ by adding $v$ by some Henneberg move $m_{last}$. By Lemma~\ref{lem:trcompsCannotBeLinked}, $T'$ is a \trcomp{} and $m_{last}$ is of type Ia or IIc. Hence, $T'$ can be constructed only by moves of type Ia by the induction assumption and if  $m_{last}$ is also of type Ia, the claim holds. 

Let $m_{last}$ be of type IIc, it means that $v$ is linked to $u_1, u_2, u\in V_{T'}$ and  $u_1u_2$ is removed. Lemma~\ref{lem:startWithArbitraryEdge} provides a sequence $m_0, m_1, \dots, m_k$ of Henneberg moves of type Ia which constructs $T'$ from $u_1u_2$. Suppose that there is a move $m_j$ which constructs some $u'\neq u$  from the edge $u_1u_2$. This is not possible since $m_{last}$ in a construction of $T$ from $T'$ removes the edge $u_1u_2$ which contradicts that neighbours of $u'$ induce a tree, see Lemma~\ref{lem:neigboursInduceTree}.

Since $u$ is the only vertex of $T'$ constructed from $u_1u_2$, we may start the construction of $T$ with the edge $u_1u$, then link the vertex $v$ by edges $u_1v$ and $uv$. After that, we link $u_2$ by edges $u_2v$ and $u_2u$. This simulates the move $m_{last}$ and we can proceed in the construction by the moves $m_1, \dots, m_k$ which constructs $T'\subset T$ from edges $u_1u$ and $u_2u$. Now we have a construction only by moves of type Ia, so we may find a construction with an arbitrary starting edge by Lemma~\ref{lem:startWithArbitraryEdge}.
\end{proof}

\begin{defn}
A graph $G=(V,E)$ is called \emph{a $k$-tree}, if either $G$ is a complete graph on $k$ vertices, or there exist a vertex $v\in V$ such that $\deg(v)=k$, the neighbours of $v$ form a $k$-clique and $G\setminus v$ is a $k$-tree.
\end{defn}

\begin{cor}
Let $T$ be a graph such that $|V_T|\geq 3$. The graph $T$ is a Laman \trcomp{} iff it is a 2-tree.
\end{cor}
Obviously, any 2-tree with at least three vertices is a Laman \trcomp{} since it is constructed by Henneberg moves Ia. On the other hand, Theorem~\ref{thm:everyTrcompByIa} provides a construction of $T$ by Henneverg moves Ia, i.e., by adjoining new vertices to existing edges.

\begin{cor}
A \trcomp{} of a Laman graph is planar.
\end{cor}
\begin{proof}
It is known that 2-tree is planar: we proceed by induction on the number of vertices of $T$. Obviously, a triangle is planar. Let $v$ be the last added vertex in a construction adjoined  to an edge $u_1u_2$. By induction assumption, there exists planar embedding of the graph $T\setminus v$ and we may embed $v$ into some neighbourhood of the edge $u_1u_2$ without edge intersections.
\end{proof}

\begin{defn}
A graph is called \emph{chordal} iff for every cycle $C\subset G$, $|C|\geq 4$, there exists \emph{a chord}, i.e., there are vertices $u,u\in V_C$ such that $uv\notin E_C$ and $uv\in E$.
\end{defn}

\begin{lem}
If a graph $T$ is a \trcomp{} (not necessarily a Laman graph), then $T$ is a chordal graph.
\end{lem}
\begin{proof}
Let $u_1, u_2, \dots, u_m=u_1$ be a cycle in $T$ such that $m>4$. Since $u_1u_2 \sim_{\!\!\bigtriangleup} u_2u_3$, there is a chord $u_1u_3$.
\end{proof}
\end{document}